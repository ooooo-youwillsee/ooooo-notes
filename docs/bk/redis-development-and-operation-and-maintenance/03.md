---
sidebarDepth: 3
---

## 1、慢查询

### 1、慢查询配置

- `slowlog-log-slower-than`: 10000 (默认值，单位微秒)，超过 10 毫秒的语句就会被记录下来。
- `slowlog-max-len`: 128（默认值），Redis 内部使用列表来保存慢查询日志。

`lowlog-log-slower-than` = 0, 会记录所有命令。

`lowlog-log-slower-than` < 0, 不会记录任何命令。

配置方式：
1. 修改配置文件 redis.conf。
2. 动态修改
```shell script
  config set lowlog-log-slower-than 20000 # 设置慢查询时间
  config set slowlog-max-len 1000 # 设置慢查询日志大小
  config rewrite  # 持久化到配置文件
```

- 慢查询命令
```shell script
  SLOWLOG GET 10 # 获取最近 10 条日志
  SLOWLOG LEN  # 获取日志条数
  SLOWLOG RESET # 慢查询日志重置
```

### 2、最佳实践

参数 `slowlog-max-len`，建议调大日志列表，比如 1000以上；参数 `slowlog-log-slower-than`，默认超过 10ms 就判断为慢查询，如果每条命令执行时间在 1ms 以上，则 1s 的并发量不足 1000，所以对于高 OPS 场景设置为 1ms。

**慢查询只记录命令执行时间，不包括命令排队和网络传输时间。**

慢查询日志只是一个先进先出的队列，如果查询较多，可能会丢失日志数据，可以利用 `SLOWLOG GET` 命令将日志存入 mysql 中，也可以利用开源工具 [CacheCloud](https://github.com/sohutv/cachecloud)。

## 2、Redis shell

## 3、Pipeline

## 4、事务与Lua

## 5、Bitmaps

## 6、HyperLogLog

## 7、发布订阅

## 8、GEO
