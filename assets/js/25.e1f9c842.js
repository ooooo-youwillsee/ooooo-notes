(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{448:function(a,s,t){a.exports=t.p+"assets/img/05_01.222dd5c7.png"},533:function(a,s,t){"use strict";t.r(s);var n=t(33),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"_1、覆盖索引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、覆盖索引"}},[a._v("#")]),a._v(" 1、覆盖索引")]),a._v(" "),s("p",[a._v("创建表 T :")]),a._v(" "),s("div",{staticClass:"language-shell script extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("mysql"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" create table T "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\nID int primary key,\nk int NOT NULL DEFAULT "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(", \ns varchar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL DEFAULT "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),a._v(",\nindex k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("engine")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("InnoDB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\ninsert into T values"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100,1")]),a._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'aa'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("200,2")]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'bb'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("300,3")]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'cc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("500,5")]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'ee'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("600,6")]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'ff'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("700,7")]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'gg'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("p",[a._v("执行语句 "),s("code",[a._v("select ID from T where k between 3 and 5")]),a._v("，只需要扫描 k 索引树。因为结果只需要查询 ID，而 ID 在 k 索引树上，减少了"),s("strong",[a._v("回表")]),a._v("操作。")]),a._v(" "),s("p",[a._v("索引树已经覆盖了查询结果，称之为"),s("strong",[a._v("覆盖索引")]),a._v("。"),s("strong",[a._v("覆盖索引可以减少树的搜索次数，显著提升查询性能。")])]),a._v(" "),s("h2",{attrs:{id:"_2、最左前缀匹配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、最左前缀匹配"}},[a._v("#")]),a._v(" 2、最左前缀匹配")]),a._v(" "),s("p",[a._v("B+ 树这种索引结构，可以利用索引的"),s("strong",[a._v("最左前缀")]),a._v("，来定位记录。")]),a._v(" "),s("p",[a._v("创建表 tuser ：")]),a._v(" "),s("div",{staticClass:"language-shell script extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("CREATE TABLE "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("tuser"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("id_card"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" varchar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DEFAULT NULL,\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("name"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" varchar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DEFAULT NULL,\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("age"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DEFAULT NULL,\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("ismale"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" tinyint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DEFAULT NULL,\n  PRIMARY KEY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("id_card"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("id_card"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("name_age"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("name"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(","),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("age"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ENGINE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("InnoDB\n")])])]),s("p",[s("img",{attrs:{src:t(448),alt:"name_age 索引树"}})]),a._v(" "),s("p",[a._v("当你的查询条件是 "),s("code",[a._v("where name like ‘张%’")]),a._v("，也是可以用到索引（name,age）的。")]),a._v(" "),s("p",[a._v("联合索引建立规则：")]),a._v(" "),s("ol",[s("li",[a._v("通过调整顺序，可以少维护一个索引，这是优先考虑的。")]),a._v(" "),s("li",[a._v("索引的空间。")])]),a._v(" "),s("h2",{attrs:{id:"_3、索引下推"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、索引下推"}},[a._v("#")]),a._v(" 3、索引下推")]),a._v(" "),s("p",[a._v("可以对索引中存在的字段先做判断，减少"),s("strong",[a._v("回表")]),a._v("次数。")]),a._v(" "),s("p",[a._v("当查询条件是 "),s("code",[a._v("where name like '张%' and age=10 and ismale=1;")]),a._v("，也是可以用到索引树（name,age）的。")]),a._v(" "),s("h2",{attrs:{id:"_4、问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、问题"}},[a._v("#")]),a._v(" 4、问题")]),a._v(" "),s("p",[a._v("有如下表：")]),a._v(" "),s("div",{staticClass:"language-shell script extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("CREATE TABLE "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("geek"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("a"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("b"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("d"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  PRIMARY KEY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("a"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(","),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("b"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("ca"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(","),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("a"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("cb"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(","),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("b"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ENGINE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("InnoDB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("p",[a._v("由于历史原因，这个表需要a、b做联合主键。\n查询语句如下：")]),a._v(" "),s("div",{staticClass:"language-shell script extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" * from geek where "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("c")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("N order by a limit "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" * from geek where "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("c")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("N order by b limit "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("p",[a._v("索引（c,a）、（c,b）是否都是必须的?")]),a._v(" "),s("p",[a._v("索引 (c,a) 不需要。")])])}),[],!1,null,null,null);s.default=e.exports}}]);