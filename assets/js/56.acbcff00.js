(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{454:function(_,v,t){"use strict";t.r(v);var a=t(25),s=Object(a.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h2",{attrs:{id:"_1、操作系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、操作系统"}},[_._v("#")]),_._v(" 1、操作系统")]),_._v(" "),t("p",[_._v("三个方面选择：")]),_._v(" "),t("ul",[t("li",[_._v("I/O 模型的使用")]),_._v(" "),t("li",[_._v("数据网络传输效率")]),_._v(" "),t("li",[_._v("社区支持度")])]),_._v(" "),t("p",[_._v("五种 I/O 模型："),t("strong",[_._v("阻塞式 I/O")]),_._v("、"),t("strong",[_._v("非阻塞式 I/O")]),_._v("、"),t("strong",[_._v("I/O 多路复用")]),_._v("、"),t("strong",[_._v("信号驱动 I/O")]),_._v(" 和"),t("strong",[_._v("异步 I/O")]),_._v("。")]),_._v(" "),t("p",[_._v("Linux 中的系统调用 select 函数就属于 I/O 多路复用模型；epoll 系统调用则介于第三种和第四种模型之间。")]),_._v(" "),t("p",[_._v("Linux 还可以使用 zero copy。")]),_._v(" "),t("p",[_._v("总结； 高性能只能选择 linux。")]),_._v(" "),t("h2",{attrs:{id:"_2、磁盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、磁盘"}},[_._v("#")]),_._v(" 2、磁盘")]),_._v(" "),t("p",[_._v("总结：")]),_._v(" "),t("ul",[t("li",[_._v("追求性价比的公司可以不搭建 RAID。")]),_._v(" "),t("li",[_._v("使用机械磁盘完全能够胜任 Kafka 线上环境。")])]),_._v(" "),t("h2",{attrs:{id:"_3、磁盘容量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、磁盘容量"}},[_._v("#")]),_._v(" 3、磁盘容量")]),_._v(" "),t("p",[_._v("规划磁盘容量的思考因素：")]),_._v(" "),t("ul",[t("li",[_._v("新增消息数")]),_._v(" "),t("li",[_._v("消息留存时间")]),_._v(" "),t("li",[_._v("平均消息大小")]),_._v(" "),t("li",[_._v("备份数")]),_._v(" "),t("li",[_._v("是否启用压缩")])]),_._v(" "),t("p",[_._v("例如： 每一天 1 亿条 1KB 大小的消息，保存两份且存留两周的时间。")]),_._v(" "),t("p",[_._v("一天数据大小： 1 亿 * 1 KB * 2 份 / 1000 / 1000 = 200 GB")]),_._v(" "),t("p",[_._v("预留 10% 的磁盘空间： 200 GB * 1.1 = 220 GB")]),_._v(" "),t("p",[_._v("两周时间： 220 GB * 14 = 3 TB")]),_._v(" "),t("p",[_._v("开启了压缩比，比如 0.75： 3 TB * 0.75 = 2.25 TB")]),_._v(" "),t("h2",{attrs:{id:"_4、带宽"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、带宽"}},[_._v("#")]),_._v(" 4、带宽")]),_._v(" "),t("p",[_._v("以 1Gbps 的千兆网络为例， 在 1 小时内处理 1TB 的业务数据，需要机器数？")]),_._v(" "),t("p",[_._v("带宽是 1Gbps，即每秒处理 1Gb 的数据，通常假设 Kafka 只能用到 70% 的带宽资源，毕竟其他进程也需要一些资源，也就是Kafka 最大只能使用 700MB 的带宽资源，常规性使用要预留 2/3，所以单台 Kafka 使用的带宽为 700 Mb / 3 = 240 Mbps。")]),_._v(" "),t("p",[_._v("1 个小时处理 1TB 数据， 1024 * 1024 / 3600 / (240 / 8) = 9.7 (注意 240 Mbps 是带宽，变为 MB 单位时，要除以 8)。")]),_._v(" "),t("p",[_._v("如果消息的副本数为 3，大约就是 30 台机器。")])])}),[],!1,null,null,null);v.default=s.exports}}]);