(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{383:function(a,s,t){a.exports=t.p+"assets/img/05_01.222dd5c7.png"},466:function(a,s,t){"use strict";t.r(s);var n=t(25),e=Object(n.a)({},(function(){var a=this,s=a.$createElement,n=a._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("h2",{attrs:{id:"_1、覆盖索引"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、覆盖索引"}},[a._v("#")]),a._v(" 1、覆盖索引")]),a._v(" "),n("p",[a._v("创建表 T :")]),a._v(" "),n("div",{staticClass:"language-shell script extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[a._v("mysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" create table T "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\nID int primary key,\nk int NOT NULL DEFAULT "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(", \ns varchar"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL DEFAULT "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),a._v(",\nindex k"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("k"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("engine")]),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("InnoDB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\ninsert into T values"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("100,1")]),a._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v("'aa'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("200,2")]),a._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[a._v("'bb'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("300,3")]),a._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[a._v("'cc'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("500,5")]),a._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[a._v("'ee'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("600,6")]),a._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[a._v("'ff'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("700,7")]),a._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[a._v("'gg'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),n("p",[a._v("执行语句 "),n("code",[a._v("select ID from T where k between 3 and 5")]),a._v("，只需要扫描 k 索引树。因为结果只需要查询 ID，而 ID 在 k 索引树上，减少了"),n("strong",[a._v("回表")]),a._v("操作。")]),a._v(" "),n("p",[a._v("索引树已经覆盖了查询结果，称之为"),n("strong",[a._v("覆盖索引")]),a._v("。"),n("strong",[a._v("覆盖索引可以减少树的搜索次数，显著提升查询性能。")])]),a._v(" "),n("h2",{attrs:{id:"_2、最左前缀匹配"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、最左前缀匹配"}},[a._v("#")]),a._v(" 2、最左前缀匹配")]),a._v(" "),n("p",[a._v("B+ 树这种索引结构，可以利用索引的"),n("strong",[a._v("最左前缀")]),a._v("，来定位记录。")]),a._v(" "),n("p",[a._v("创建表 tuser ：")]),a._v(" "),n("div",{staticClass:"language-shell script extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[a._v("CREATE TABLE "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("tuser"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n  "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("id_card"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" varchar"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DEFAULT NULL,\n  "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("name"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" varchar"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DEFAULT NULL,\n  "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("age"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DEFAULT NULL,\n  "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("ismale"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" tinyint"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" DEFAULT NULL,\n  PRIMARY KEY "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("id_card"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("id_card"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("name_age"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("name"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(","),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("age"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("InnoDB\n")])])]),n("p",[n("img",{attrs:{src:t(383),alt:"name_age 索引树"}})]),a._v(" "),n("p",[a._v("当你的查询条件是 "),n("code",[a._v("where name like ‘张%’")]),a._v("，也是可以用到索引（name,age）的。")]),a._v(" "),n("p",[a._v("联合索引建立规则：")]),a._v(" "),n("ol",[n("li",[a._v("通过调整顺序，可以少维护一个索引，这是优先考虑的。")]),a._v(" "),n("li",[a._v("索引的空间。")])]),a._v(" "),n("h2",{attrs:{id:"_3、索引下推"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、索引下推"}},[a._v("#")]),a._v(" 3、索引下推")]),a._v(" "),n("p",[a._v("可以对索引中存在的字段先做判断，减少"),n("strong",[a._v("回表")]),a._v("次数。")]),a._v(" "),n("p",[a._v("当查询条件是 "),n("code",[a._v("where name like '张%' and age=10 and ismale=1;")]),a._v("，也是可以用到索引树（name,age）的。")]),a._v(" "),n("h2",{attrs:{id:"_4、问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4、问题"}},[a._v("#")]),a._v(" 4、问题")]),a._v(" "),n("p",[a._v("有如下表：")]),a._v(" "),n("div",{staticClass:"language-shell script extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[a._v("CREATE TABLE "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("geek"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n  "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("a"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("b"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("d"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" int"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOT NULL,\n  PRIMARY KEY "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("a"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(","),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("b"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("ca"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(","),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("a"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(",\n  KEY "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("cb"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("c"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(","),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("b"),n("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("InnoDB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),n("p",[a._v("由于历史原因，这个表需要a、b做联合主键。\n查询语句如下：")]),a._v(" "),n("div",{staticClass:"language-shell script extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" * from geek where "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("c")]),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("N order by a limit "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" * from geek where "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("c")]),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("N order by b limit "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),n("p",[a._v("索引（c,a）、（c,b）是否都是必须的?")]),a._v(" "),n("p",[a._v("索引 (c,a) 不需要。")])])}),[],!1,null,null,null);s.default=e.exports}}]);