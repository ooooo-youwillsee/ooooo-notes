(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{401:function(a,e,s){"use strict";s.r(e);var t=s(18),r=Object(t.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"_1ã€topic-çº§åˆ«å‚æ•°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€topic-çº§åˆ«å‚æ•°"}},[a._v("#")]),a._v(" 1ã€Topic çº§åˆ«å‚æ•°")]),a._v(" "),s("p",[a._v("å¦‚æœåŒæ—¶è®¾ç½®äº† Topic çº§åˆ«å‚æ•°å’Œå…¨å±€ Broker å‚æ•°ï¼ŒTopic çº§åˆ«å‚æ•°ä¼šè¦†ç›–å…¨å±€ Broker å‚æ•°çš„å€¼ï¼Œè€Œæ¯ä¸ª Topic éƒ½èƒ½è®¾ç½®è‡ªå·±çš„å‚æ•°å€¼ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ Topic çº§åˆ«å‚æ•°ã€‚")]),a._v(" "),s("ol",[s("li",[s("p",[s("code",[a._v("retention.ms")]),a._v(": è¯¥ Topic æ¶ˆæ¯è¢«ä¿å­˜çš„æ—¶é•¿ï¼Œä¼šè¦†ç›–æ‰ Broker ç«¯çš„å…¨å±€å‚æ•°å€¼ã€‚")])]),a._v(" "),s("li",[s("p",[s("code",[a._v("retention.bytes")]),a._v(": è¯¥ Topic é¢„ç•™å¤šå¤§çš„ç£ç›˜ç©ºé—´ï¼Œå½“å‰é»˜è®¤å€¼æ˜¯ -1ï¼Œè¡¨ç¤ºå¯ä»¥æ— é™ä½¿ç”¨ç£ç›˜ç©ºé—´ï¼Œåœ¨å¤šç§Ÿæˆ·çš„ Kafka é›†ç¾¤ä¸­ç”¨åˆ°ã€‚")])]),a._v(" "),s("li",[s("p",[s("code",[a._v("max.message.bytes")]),a._v(": Topic çš„æœ€å¤§æ¶ˆæ¯å¤§å°ã€‚")])])]),a._v(" "),s("p",[a._v("Topic è®¾ç½®æ–¹å¼ï¼ˆğŸ‰"),s("a",{attrs:{href:"http://kafka.apache.org/documentation/#topicconfigs",target:"_blank",rel:"noopener noreferrer"}},[a._v("Kafkaå®˜æ–¹æ–‡æ¡£"),s("OutboundLink")],1),a._v("ğŸ‰ï¼‰ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("åˆ›å»º Topic æ—¶è®¾ç½®")])]),a._v(" "),s("p",[a._v("--config åé¢æŒ‡å®šäº†æƒ³è¦è®¾ç½®çš„ Topic çº§åˆ«å‚æ•°ã€‚")]),a._v(" "),s("div",{staticClass:"language-shell script extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("bin/kafka-topics.sh --bootstrap-server localhost:9092 --create --topic my-topic --partitions "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" --replication-factor "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" --config retention.ms"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("15552000000")]),a._v(" --config max.message.bytes"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5242880")]),a._v("\n")])])]),s("ul",[s("li",[a._v("ä¿®æ”¹ Topic æ—¶è®¾ç½®")])]),a._v(" "),s("div",{staticClass:"language-shell script extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v(" bin/kafka-configs.sh --zookeeper localhost:2181 --entity-type topics --entity-name my-topic --alter --add-config max.message.bytes"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10485760")]),a._v("\n")])])]),s("h2",{attrs:{id:"_2ã€jvm-å‚æ•°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€jvm-å‚æ•°"}},[a._v("#")]),a._v(" 2ã€JVM å‚æ•°")]),a._v(" "),s("p",[a._v("Java7 ä¸­ï¼Œå¦‚æœ Broker æ‰€åœ¨æœºå™¨çš„ CPU èµ„æºéå¸¸å……è£•ï¼Œåˆ™å»ºè®®å¼€å¯ CMS åƒåœ¾å›æ”¶å™¨, "),s("code",[a._v("-XX:+UseCurrentMarkSweepGC")]),a._v("ã€‚å¦åˆ™ï¼Œä½¿ç”¨ååé‡æ”¶é›†å™¨ã€‚å¼€å¯æ–¹æ³•æ˜¯æŒ‡å®š"),s("code",[a._v("-XX:+UseParallelGC")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("Java8 ä¸­ï¼Œå»ºè®®ä½¿ç”¨ G1 åƒåœ¾å›æ”¶å™¨ã€‚")]),a._v(" "),s("p",[a._v("å»ºè®®ä½¿ç”¨ Java8ã€‚")]),a._v(" "),s("ol",[s("li",[s("p",[s("code",[a._v("KAFKA_HEAP_OPTS")]),a._v(": å †å¤§å°, å»ºè®®ä¸º 6GBï¼Œè¿™æ˜¯æ¯”è¾ƒå…¬è®¤çš„åˆç†å€¼ã€‚")])]),a._v(" "),s("li",[s("p",[s("code",[a._v("KAFKA_JVM_PERFORMANCE_OPTS")]),a._v(": æŒ‡å®š GC å‚æ•°ã€‚")])])]),a._v(" "),s("p",[a._v("æ¯”å¦‚ä½ å¯ä»¥è¿™æ ·å¯åŠ¨ Kafkaï¼š")]),a._v(" "),s("div",{staticClass:"language-shell script extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("KAFKA_HEAP_OPTS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("--Xms6g  --Xmx6g\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("KAFKA_JVM_PERFORMANCE_OPTS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" -server -XX:+UseG1GC -XX:MaxGCPauseMillis"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v(" -XX:InitiatingHeapOccupancyPercent"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("35")]),a._v(" -XX:+ExplicitGCInvokesConcurrent -Djava.awt.headless"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true\nbin/kafka-server-start.sh config/server.properties\n")])])]),s("h3",{attrs:{id:"_3ã€æ“ä½œç³»ç»Ÿå‚æ•°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3ã€æ“ä½œç³»ç»Ÿå‚æ•°"}},[a._v("#")]),a._v(" 3ã€æ“ä½œç³»ç»Ÿå‚æ•°")]),a._v(" "),s("p",[a._v("ä¸»è¦ç³»ç»Ÿå‚æ•°ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("æ–‡ä»¶æè¿°ç¬¦é™åˆ¶")])]),a._v(" "),s("p",[a._v("æ‰§è¡Œå‘½ä»¤ "),s("code",[a._v("ulimit -n 1000000")]),a._v(" æ¥è®¾ç½®ã€‚")]),a._v(" "),s("ul",[s("li",[a._v("æ–‡ä»¶ç³»ç»Ÿç±»å‹")])]),a._v(" "),s("p",[a._v("XFS çš„æ€§èƒ½è¦å¼ºäº ext4ã€‚")]),a._v(" "),s("ul",[s("li",[a._v("Swappiness")])]),a._v(" "),s("p",[a._v("å°† swap äº¤æ¢å†…å­˜é…ç½®æˆä¸€ä¸ªæ¥è¿‘ 0 ä½†ä¸ä¸º 0 çš„å€¼ï¼Œæ¯”å¦‚ 1ã€‚")]),a._v(" "),s("ul",[s("li",[a._v("æäº¤æ—¶é—´")])]),a._v(" "),s("p",[a._v('å‘ Kafka å‘é€æ•°æ®å¹¶ä¸æ˜¯çœŸè¦ç­‰æ•°æ®è¢«å†™å…¥ç£ç›˜æ‰ä¼šè®¤ä¸ºæˆåŠŸï¼Œè€Œæ˜¯åªè¦æ•°æ®è¢«å†™å…¥åˆ°æ“ä½œç³»ç»Ÿçš„é¡µç¼“å­˜ï¼ˆPage Cacheï¼‰ä¸Šå°±å¯ä»¥äº†ï¼Œéšåæ“ä½œç³»ç»Ÿæ ¹æ® LRU ç®—æ³•ä¼šå®šæœŸå°†é¡µç¼“å­˜ä¸Šçš„"è„"æ•°æ®è½ç›˜åˆ°ç‰©ç†ç£ç›˜ä¸Šã€‚è¿™ä¸ªå®šæœŸå°±æ˜¯ç”±æäº¤æ—¶é—´æ¥ç¡®å®šçš„ï¼Œé»˜è®¤æ˜¯ 5 ç§’ã€‚ç”±äº Kafka çš„å¤šå‰¯æœ¬çš„å†—ä½™æœºåˆ¶ï¼Œå¯ä»¥ç¨å¾®æ‹‰å¤§æäº¤é—´éš”æ¥æé«˜æ€§èƒ½ã€‚')])])}),[],!1,null,null,null);e.default=r.exports}}]);